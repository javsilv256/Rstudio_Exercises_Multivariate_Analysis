{
  "hash": "d41afe42fd1345a82cdbc5e9011396a9",
  "result": {
    "markdown": "---\ntitle: \"2023-02-02 Sessión 3\"\nformat: \n  html:\n    self-contained: true\n---\n\n\n-   Instituut Voor Tropische Geneeskunde - Antwerp, Belgium\n-   Javier Silva-Valencia\n\n## Step by Step\n\n##### Import data\n\nImporting a CSV database under the name of \"usamod\", with \",\" as separator and \".\" as decimal:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusamod <- read.csv(\"C:/Users/pined/OneDrive - Universidad Nacional Mayor de San Marcos/Javier 2022/Belgica/AC2/Linear Regresion Exercise Database/Datasets/usamod.csv\", sep=\",\", dec= \".\")\n```\n:::\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n### Starting the Exercise:\n\nThe data represents a sample of 28 women. Those with ID 1 to 11 come from Pizzana, while those with ID 12 to 28 come from Steakosin\n\n##### 1. Perform the regresion analysis on the association between cholesterol and age. Write down the equation of the model. What can you say this model.\n\nIndependant variable: Age (numeric) Dependant variable: Cholesterol (numeric)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Code in R:\nlmCholes_Age = lm(cholest ~ age, data = usamod)\nsummary(lmCholes_Age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cholest ~ age, data = usamod)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-95.934 -13.378   0.277  24.525  67.230 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 119.5947    21.8781   5.466 9.86e-06 ***\nage           1.8612     0.4322   4.307 0.000209 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 36.55 on 26 degrees of freedom\nMultiple R-squared:  0.4164,\tAdjusted R-squared:  0.3939 \nF-statistic: 18.55 on 1 and 26 DF,  p-value: 0.0002092\n```\n:::\n:::\n\n\n::: callout-note\n-A. As a result: we can recreate the formula with the data we obtained\n\n    * y = a+b(x)\n    * a= 119.5947\n    * b = 1.8612\n        \"For every increase of 1 in age, the cholesterol would increase in 1.86\"\n    So, the formula would be:\n    * Y= 119.5947 +1.8612(X)\n      \n\n-B. We also find the R2\n\n    * R2 is the \"Determination coefficient\". \n    * R2 =  0.4164\n    Interpretation: \n    \"41% of the variability of the Cholesterol could be explained by the model\"\n        \n\n-C. We also find the p value = 0.0002092\n\n    Interpretation:\n    *P value in this case says that there is a statisticas association between Cholesterol\n    and age (that is the same that says that \"the slope of the regresion line \n    is significanly different from zero)\n        \n\n-D. As another result we have the \"correlation coefficient\"\n\n          Correlation coefficient = Square root of R2\n    So:\n          Correlation coefficient (r) = sqrt(0.4164)\n          Correlation coefficient (r) = 0.6452906\n    Interpretation: \n        \"The value of 0.64 suggest a strong positive association\"\n:::\n\n##### 2.Now generate a new variable called State (according tho the statement at the beggining). Add State to the model and write down the equation for each categorie. Does the addition of State improve the model significantly? Is this a parallell lines model or a separate lines model?\n\n2.1 Creating the variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Creating the variable\n    usamod$state <-  \"steakosin\"                    #Creating a variable w/only \"steakosin\"\n    usamod$state[usamod$id<12] <- \"pizzana\"         #Replacing where id<12\n#When used the pizzana would be the reference (alphabetical order)\n```\n:::\n\n\n2.2 Puting inside the model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Code in R:\nlmCholes_Age_Stat = lm(cholest ~ age + state, data = usamod)\nsummary(lmCholes_Age_Stat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cholest ~ age + state, data = usamod)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-77.254 -17.669  -0.846  15.964  77.837 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     87.9993    24.7809   3.551  0.00155 ** \nage              2.1303     0.4199   5.074 3.08e-05 ***\nstatesteakosin  30.7509    13.7423   2.238  0.03439 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 34.03 on 25 degrees of freedom\nMultiple R-squared:  0.5138,\tAdjusted R-squared:  0.4749 \nF-statistic: 13.21 on 2 and 25 DF,  p-value: 0.0001218\n```\n:::\n:::\n\n\n::: callout-note\n-   The equations for each categorie are:\n\n        When State is Pizzana (0): \n            y = 87.9993 + 2.1303(Age) + 30.7509(0)\n        When State is Steakonsin (1): \n            y = 87.9993  + 2.1303(Age) + 30.7509(1)\n            y = 118.7502 + 2.1303(Age)\n\n-   The \"Determination coefficient\" is:\n\n    -   R2 = 0.5138 \"51% of the variability of the Cholesterol could be explained by the model\" (It is better that the previous model, but this improve is significant?)\n:::\n\n2.3 Seeing if it improves significantly\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Code for ANOVA\n    anova (lmCholes_Age,lmCholes_Age_Stat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: cholest ~ age\nModel 2: cholest ~ age + state\n  Res.Df   RSS Df Sum of Sq      F  Pr(>F)  \n1     26 34742                              \n2     25 28945  1    5797.3 5.0073 0.03439 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n::: callout-note\nThe p value is 0.03 (less than 0.05) so the difference it is significant So, this new model (lmCholes_Age_Stat) is better. This is a parallel lines model\n\nBut So far has prove that that in the model should be included Age and also State. But: Should the model stay like this putting state as an another variable (parallel lines) or should be put state as an interaction variable (separate lines)?\n:::\n\n##### 3.As the next step please fit a separate lines model by using interaction. Please write down the equations for pizzana and steakconsin. Is this model significantly better than the parallel lines model?\n\n3.1 Creating the model with interaction\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Code in R:\nlmCholes_Age_Stat_INTERAC = lm(cholest ~ age*state, data = usamod)\nsummary(lmCholes_Age_Stat_INTERAC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cholest ~ age * state, data = usamod)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-67.655 -19.951  -6.884  24.689  59.409 \n\nCoefficients:\n                   Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -2.0506    40.2844  -0.051  0.95982    \nage                  3.8064     0.7300   5.214 2.42e-05 ***\nstatesteakosin     147.6374    45.3424   3.256  0.00335 ** \nage:statesteakosin  -2.2811     0.8517  -2.678  0.01314 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 30.47 on 24 degrees of freedom\nMultiple R-squared:  0.6257,\tAdjusted R-squared:  0.5789 \nF-statistic: 13.37 on 3 and 24 DF,  p-value: 2.468e-05\n```\n:::\n:::\n\n\n::: callout-note\n-   The new equations for each categorie are:\n\n        When State is Pizzana (0): \n            y = -2.0506 + 3.8064(Age) + 0 + 0\n        When State is Steakonsin (1): \n            y = -2.0506  + 3.8064(Age) + 147.6374(1) + -2.2811(Age)(1)\n            y = 145.5868 + 1.5253(Age)\n\n-   The new \"Determination coefficient\" is:\n\n    -   R2 = 0.6257 \"62% of the variability of the Cholesterol could be explained by the model\" (It is better that the previous model, but this improve is significant?)\n:::\n\n3.2 Seeing if it improves significantly\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Code for ANOVA\n    anova (lmCholes_Age_Stat,lmCholes_Age_Stat_INTERAC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: cholest ~ age + state\nModel 2: cholest ~ age * state\n  Res.Df   RSS Df Sum of Sq      F  Pr(>F)  \n1     25 28945                              \n2     24 22284  1    6660.9 7.1738 0.01314 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n::: callout-note\nThe p value is 0.01314 (less than 0.05) so the difference it is significant So, this new model (lmCholes_Age_Stat_INTERAC) is better.\n\nThis also means that the State acts as an interaction variable, and that the regression should be presented only between 1.cholesterol and 2.age but presented separately by each group of State\n\n(In the case of not having been significant, it would have meant that the \"State\" doesnt acts as an interaction variable, and that the regression should be presented between 1.cholesterol, 2.age and 3.state)\n:::\n\n##### 4. Make an scatterplot with \"Age\" as X-variable, \"cholesterol\" as Y-variable and a regressión line for each category of \"state\". At what age do the two regressions line cross? Can you calculate the age at which the lines cross from the equation in question 3?\n\n4.1 Creating the scatterplot and linear regression only for cholest \\~ age\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#We will try it with ggplot\nlibrary(tidyverse)                          #Install the package\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#creating the graph for a linear regression of \"lm(cholest ~ age, data = usamod)\"\nggplot(usamod, aes(x=age, y=cholest)) +     \n  geom_point(size=2) +\n  geom_smooth(method=lm, se=FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](2023-02-02-Linear-Regresion,-Sessión-3_Aft_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n4.2 Creating the scatterplot and linear regression for cholest \\~ age for each category of state\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#creating the graph for a linear regression of \"lm(cholest ~ age*state, data = usamod)\"\nggplot(usamod, aes(x=age, y=cholest, color = state)) + \n  geom_point(size=2) +\n  geom_smooth(method=lm, se=FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](2023-02-02-Linear-Regresion,-Sessión-3_Aft_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n4.3 Calculate the age at witch the two lines cross ::: callout-note So before (in section 3.1) we have calculate the equations for the linear regression of cholesterol and age with state acting as a interaction variable:\n\n      When State is Pizzana (0): \n          y = -2.0506 + 3.8064(Age) + 0 + 0\n      When State is Steakonsin (1): \n          y = -2.0506  + 3.8064(Age) + 147.6374(1) + -2.2811(Age)(1)\n          y = 145.5868 + 1.5253(Age)\n          \n      So if there is a point that both equations have the same \"Cholesterol\" value, we can calculate the Age:\n          \n          -2.0506 + 3.8064(Age) = 145.5868 + 1.5253(Age)\n                   2.2811 (Age) = 147.6374\n                          (Age) = 64.72202\n\n:::\n",
    "supporting": [
      "2023-02-02-Linear-Regresion,-Sessión-3_Aft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}