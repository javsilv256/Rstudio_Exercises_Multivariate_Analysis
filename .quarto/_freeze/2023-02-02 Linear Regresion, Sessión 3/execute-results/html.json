{
  "hash": "f9ba32479dbc1fef537e11a92e0b465f",
  "result": {
    "markdown": "---\ntitle: \"2023-02-02 Linear Regresion, Sessión 3\"\nformat: \n  html:\n    self-contained: true\n---\n\n\n-   Instituut Voor Tropische Geneeskunde - Antwerp, Belgium\n-   Javier Silva-Valencia\n\n## Step by Step\n\n##### Import data\n\nImporting a CSV database under the name of \"cholest\", with \",\" as separator and \".\" as decimal:\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-1_70448d76198b871396b379ae01e760f0'}\n\n```{.r .cell-code .numberLines}\ncholest <- read.csv(\"C:/Users/pined/OneDrive - Universidad Nacional Mayor de San Marcos/Javier 2022/Belgica/AC2/Linear Regresion Exercise Database/Datasets/Cholesterol.csv\", sep=\",\", dec= \".\")\n```\n:::\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n### Starting the Exercise:\n\nWe want to respond to the question: How do we best explain the variability of cholesterol with the data we have?\n\n##### 1. We explore the variables - Cleaning\n\n1.1 Cholesterol\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-2_8d95c69b03cc778bca212d6e23f87978'}\n\n```{.r .cell-code .numberLines}\nhist(cholest$cholesterol)\n```\n\n::: {.cell-output-display}\n![](2023-02-02-Linear-Regresion,-Sessión-3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n-Cholesterol seems ok\n:::\n\n1.2 Activity\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-3_04d2c04e07cefe157492885922ded440'}\n\n```{.r .cell-code .numberLines}\nhist(cholest$activity)\n```\n\n::: {.cell-output-display}\n![](2023-02-02-Linear-Regresion,-Sessión-3_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code .numberLines}\nsummary(cholest$activity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    5.00    8.50   10.92   15.50   26.00 \n```\n:::\n:::\n\n\n::: callout-note\n-Activity seems ok\n:::\n\n1.3 Occupation\n\n1.3.1 First we see the values of the variable if they make sense\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-4_c3decfda72274606e01e490208a04f2c'}\n\n```{.r .cell-code .numberLines}\ntable(cholest$occupation)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n1 2 3 4 \n4 7 6 7 \n```\n:::\n:::\n\n\n::: callout-note\n-Seems ok, Occupation only have 4 categories, and there are 4 categories in my data\n:::\n\n1.3.2 Second we see if the variable is in a categorical or numerical way as I want. Ocupation is in a numerical way, need to change it to a factor\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-5_364cde32f080d1fb76dd6f17412101ff'}\n\n```{.r .cell-code .numberLines}\ncholest$occupation_f <- factor(cholest$occupation)\n```\n:::\n\n\n1.3.2 Then, we have to be sure that the first category of the variable should be the reference category\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-6_f83f3ee63c5c6e71b6e6c0cc33c9b2d7'}\n\n```{.r .cell-code .numberLines}\n#\ncholest$occupation_f <- factor(cholest$occupation)\n```\n:::\n\n\n::: callout-note\n-activity seems ok\n:::\n\n##### Doing the modeling - linear regresion - Method: Change-in-estimate model\n\nModel with inly the primary expouse variable\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-7_6fe77286a7c353026d80a73992eb82e6'}\n\n```{.r .cell-code .numberLines}\nmod1 <- lm(cholesterol ~ activity, data=cholest)\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cholesterol ~ activity, data = cholest)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.85397 -0.49306 -0.06166  0.34349  1.25118 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  4.05397    0.22507  18.012 1.17e-14 ***\nactivity    -0.06410    0.01704  -3.762  0.00108 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6205 on 22 degrees of freedom\nMultiple R-squared:  0.3914,\tAdjusted R-squared:  0.3638 \nF-statistic: 14.15 on 1 and 22 DF,  p-value: 0.001077\n```\n:::\n:::\n\n\nModel with two independent variables\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-8_31d3bb85cf3bc566e9f9271e360ff2e8'}\n\n```{.r .cell-code .numberLines}\nmod2 <- lm(cholesterol ~ activity + age, data=cholest)\n#mod3 <- lm(cholesterol ~ activity + bmi_cat, data=cholest)\n#mod4 <- lm(cholesterol ~ activity + sex_f, data=cholest)\n#mod5 <- lm(cholesterol ~ activity + occupation_f, data=cholest)\n```\n:::\n\n\nsummary(mod2) summary(mod3) summary(mod4) summary(mod5)\n\nAfter see the % of change we see that only \"activity+age\" and \"activity+BMI\" has a change % higher than 10\n\nMultivariate model\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-9_82b632b027f7709e7bee020a01c5468f'}\n\n```{.r .cell-code .numberLines}\n#mod6 <- lm(cholesterol ~ activity + age + bmi_cat, data=cholest)\n#summary(mod6)\n```\n:::\n\n\nThe adjusted effect of activity is: -0.016\n\nMultivatiate model without age\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-10_489b21c41852f57c22b4c98f1e86c81c'}\n\n```{.r .cell-code .numberLines}\n#mod7 <- lm(cholesterol ~ activity + bmi_cat, data=cholest)\n#summary(mod7)\n```\n:::\n\n\nThe adjusted effect of activity now is: -0.029\n\nIs that a substancial change? (-0.029 - -0.016)/-0.016 81% Yes, it is a substancial change, so we shoulnt take age of the equation\n\nMultivatiate model without bmi\n\n\n::: {.cell hash='2023-02-02-Linear-Regresion,-Sessión-3_cache/html/unnamed-chunk-11_052b3de738c52aac94748ee0fc24ddb1'}\n\n```{.r .cell-code .numberLines}\nmod8 <- lm(cholesterol ~ activity + age, data=cholest)\nsummary(mod8)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cholesterol ~ activity + age, data = cholest)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.65374 -0.23438 -0.04463  0.20482  0.54035 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.67711    0.32871   5.102 4.71e-05 ***\nactivity    -0.01687    0.01078  -1.565    0.132    \nage          0.04722    0.00610   7.741 1.39e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3235 on 21 degrees of freedom\nMultiple R-squared:  0.8421,\tAdjusted R-squared:  0.827 \nF-statistic: 55.99 on 2 and 21 DF,  p-value: 3.836e-09\n```\n:::\n:::\n\n\nThe adjusted effect of activity now is: -0.017\n\nIs that a substancial change? (-0.017 - -0.016)/-0.016 6% No, it is not a substancial change, so we can take BMI of the equation\n\nSo the final model (the more simple) is cholesterol \\~ activity + age Mod8\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}