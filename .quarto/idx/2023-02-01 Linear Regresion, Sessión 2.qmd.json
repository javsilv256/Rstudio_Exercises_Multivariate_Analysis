{"title":"2023-02-01. Session 2","markdown":{"yaml":{"title":"2023-02-01. Session 2","format":{"html":{"self-contained":true}}},"headingText":"Step by Step","containsRefs":false,"markdown":"\n\n-   Instituut Voor Tropische Geneeskunde - Antwerp, Belgium\n-   Javier Silva-Valencia\n\n\n##### Import data\n\nImporting a CSV database under the name of \"evans\", with \",\" as separator and \".\" as decimal:\n\n```{r}\nevans <- read.csv(\"C:/Users/pined/OneDrive - Universidad Nacional Mayor de San Marcos/Javier 2022/Belgica/AC2/Linear Regresion Exercise Database/Datasets/evans_county.csv\", sep=\",\", dec= \".\")\n```\n\nWe assume that all variables ok to start (we dont need to transform or create variables)\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n### Starting the Exercise:\n\nIs the Queteled Index(QTI) associated with systolic blood pressure(SBP)?\n\nIndependent variable: QTI\n\nDependent variable: SBP\n\n##### 0. It is a good practice to explore the data. In this case with a scatterplot\n\n```{r}\n#Code in R:          \n  # Make a scatterplot\n  plot(evans$QTI, evans$SBP, main=\"Scatterplot\")\n  # add a regression line\n  abline(lm(SBP~QTI, data = evans), col = \"blue\")\n```\n\n::: callout-note\n-We can see that there could be a correlation, although it seen not very strong\n:::\n\n##### 1. What is the regressión equation?\n\n```{r}\n#Code for linear regresion:\n  lmQTI = lm(SBP ~ QTI, data = evans)\n  summary(lmQTI)\n```\n\n::: callout-note\n-As a result: we can create the equation with the data we obtained\n\n    * Formula:  y = a+b(x)\n    * a = 129.420\n    * b = 4.439\n        (b is the slope, \n        it means that for every increase of 1 in QTI the SBP increase in 4.43)\n\n    So, the equation would be:\n    * Y= 129.420 + 4.439(X)\n:::\n\n##### 2. How much is the determination coefficient? What does it mean?\n\n::: callout-note\n-The determination coefficient is R2 = 0.009\n\n    Interpretation: \n    \" __%  of the variability of the outcome could be explained by the model \"\n    \"0.9% of the variability of the SBP(blood preasure) could be explained by the model\"\n:::\n\n##### 3. Is the slope for QTI statiscally significant?\n\n::: callout-note\n-The slope for QTI is 4.439 -And its p value is 0.0183 (less than 0.05)\n\n    Interpretation: \n    *P value in this case says that there is a statisticas association (that is the same that       says that \"the slope of the regresion line is significanly different from zero)\n:::\n\n### Testing the assumptions (linearity, homogeneity of variance, normality...)\n\nFirst we need to calculate the residuals an calculate the estimated outcome(fitted) as new variables\n\n```{r}\nevans$mod_resid <- residuals(lmQTI)\nevans$mod_fitted <- fitted(lmQTI)\n```\n\n##### 4. Is the association betwenn SBP and QTI a linear association?\n\nWe scatterplot the residuals against the exposure(VI)\n\n```{r}\n#Code in R:          \n  # Make a scatterplot\n  plot(evans$QTI, evans$mod_resid, main=\"Scatterplot\")\n  # add a regression line\n  abline(lm(mod_resid~QTI, data = evans), col = \"blue\")\n```\n\n::: callout-note\n    We scatterplot the residuals against the exposure(VI) \n    In this case because we see it as a cloud, then we assume linearity\n:::\n\n##### 5. Is the variance of the residuals homogeneous?\n\nWe scatterplot the residuals against the estimated outcome(fitted)\n\n```{r}\n#Code in R:          \n  # Make a scatterplot\n  plot(evans$mod_fitted, evans$mod_resid, main=\"Scatterplot\")\n  # add a regression line\n  abline(lm(mod_resid ~ mod_fitted, data = evans), col = \"blue\")\n```\n\n::: callout-note\n    We residuals against the estimated outcome(fitted)\n    In this case because we see it as a cloud, then we assume homogeneity\n:::\n\n##### 6. Are the residuals normally distributted?\n\n```{r}\n#Doing an histogram of the residuals\n  hist(evans$mod_resid,main=\"Age distribution of study participants\", \n     xlab=\"Age (years)\", ylab=\"nb\", col=\"green\", border=\"dark green\")\n```\n\n::: callout-note\n    Seems not\n:::\n\n##### 7. Are the observations independent?\n\n::: callout-note\n    We dont need any calculation for this.\n    Because we are not working with sequential measures (in time or in space):\n      The observations  are  independent\n:::\n\n##### 8. Are there any extreme values?\n\n::: callout-note\n    For this we need to made a scatter plot of the residuals against the estimated outcome (fitted) (we already did this in step 5 )\n\n    For discussion. It seems to have some extreme values.\n:::\n\n##### 9. Are there any influential observation?\n\n::: callout-note\n    For this we need to made a scatter plot of the residuals against the exposure (we already did this in step 4 )\n\n    For discussion. It seems to have some influential observations.\n:::\n\n##### 10. Does the model significantly improve when the variable AGE is added?\n\nWe do this doing an multivariate linear regresion\n\n```{r}\n#Code for linear regresion:\n  lmQTI_AGE = lm(SBP ~ QTI+AGE, data = evans)\n  summary(lmQTI_AGE)\n```\n\n::: callout-note\n-A. As a result: we can create the new formula with the data we obtained\n\n    * y = a + b1(x1) + b2(x2)\n    * a= 73.4912\n    * b1 = 5.6031\n    * b2 = 0.9630\n    So, the formula would be:\n    * Y= 73.4912 + 5.6031(QTI) + 0.9630(AGE)\n\n-B. We also find the R2\n\n    * R2 is the \"Determination coefficient\". \n    * R2 =  0.1136\n    Interpretation: \n    \"11% of the variability of the SBP could be explained by the model\"\n\n-C. Does the model significantly improve when the variable AGE is added?\n\n    * It improves, but I dont know if it is a significantly improvement. \n:::\n\nTo know if it is a significantly improvement, we can do an anova table comparing the 2 models\n\n```{r}\n#Code for ANOVA\n    anova (lmQTI,lmQTI_AGE)\n```\n\n::: callout-note\np = 2.2e-16 The second model has a significant difference to the first model, so including AGE has increased significantly the model.\n:::\n\n##### 11. Which proportion of the variability in SBP is explained by this model?\n\n::: callout-note\nWe already did it at step 10 \\* R2 is the \"Determination coefficient\". \\* R2 = 0.1136 Interpretation: \"11% of the variability of the SBP could be explained by the model\"\n:::\n\n##### 12. Please write down the equation of the model\n\n::: callout-note\nWe already did it at step 10 \\* y = a + b1(x1) + b2(x2) \\* a= 73.4912 \\* b1 = 5.6031 \\* b2 = 0.9630 So, the formula would be: \\* Y= 73.4912 + 5.6031(QTI) + 0.9630(AGE)\n:::\n\nFinish =)\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"self-contained":true,"output-file":"2023-02-01 Linear Regresion, Sessión 2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":{"light":"flatly"},"title":"2023-02-01. Session 2"},"extensions":{"book":{"multiFile":true}}}}}